<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Americano Beach Tennis - Scores & Classements</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    body { margin: 0; padding: 0; background: #f4f4f8; color: #222; }
    header {
      background: linear-gradient(135deg,#1f7ac4,#00a6d6);
      color: white;
      padding: 1rem 1.3rem;
      display:flex;
      align-items:center;
      gap:1rem;
    }
    header img.logo {
      height: 42px;
      width:auto;
      border-radius:8px;
      background:rgba(255,255,255,0.1);
      padding:4px;
    }
    header h1 { margin: 0; font-size: 1.4rem; }
    header p { margin: 0.3rem 0 0; font-size: 0.9rem; opacity: 0.9; }
    main { padding: 1rem; max-width: 1100px; margin: 0 auto 2rem; }
    h2 { margin-top: 1.2rem; font-size: 1.2rem; }
    .card {
      background: white;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }
    .players-list { display: flex; flex-wrap: wrap; gap: .5rem .75rem; font-size: 0.9rem; }
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 0.2rem 0.5rem;
      border-radius: 999px;
      background: #eef5ff;
    }
    .badge span.role {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-right: 0.35rem;
      padding: 0.1rem 0.35rem;
      border-radius: 999px;
      color: white;
    }
    .badge span.role.H { background: #1f7ac4; }
    .badge span.role.F { background: #e84a8a; }
    .badge span.name { font-weight: 500; }
    table { border-collapse: collapse; width: 100%; font-size: 0.85rem; }
    th, td {
      border-bottom: 1px solid #e0e0e0;
      padding: 0.35rem 0.4rem;
      text-align: left;
    }
    th {
      background: #f0f4ff;
      font-weight: 600;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }
    tr:nth-child(even) td { background: #fafafa; }
    input[type="number"] {
      width: 3rem;
      padding: 0.1rem 0.2rem;
      font-size: 0.8rem;
    }
    select {
      font-size: 0.8rem;
      padding: 0.1rem 0.2rem;
    }
    .matches-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      align-items: center;
      justify-content: space-between;
    }
    button {
      border-radius: 999px;
      border: none;
      padding: 0.4rem 0.9rem;
      font-size: 0.8rem;
      cursor: pointer;
      background: #1f7ac4;
      color: white;
      font-weight: 500;
    }
    button.secondary { background: #e0e0e0; color: #333; }
    button.danger { background: #e05050; }
    button:disabled { opacity: 0.5; cursor: default; }
    .standings-container {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1fr) minmax(0, 1fr);
      gap: 0.75rem;
    }
    @media (max-width: 900px) {
      .standings-container { grid-template-columns: minmax(0,1fr); }
    }
  </style>
</head>

<body>
<header>
  <img src="logo.svg" alt="Logo club" class="logo" />
  <div>
    <h1>Americano Beach Tennis ‚Äì Scores & Classements</h1>
    <p>Mini-site interactif du tournoi mixte (BTSuzini).</p>
  </div>
</header>

<main>
  <section class="card">
    <h2>üë• Joueurs</h2>
    <p style="margin-top:0;">Liste des participants (hommes & femmes).</p>
    <div class="players-list" id="playersList"></div>
  </section>

  <section class="card">
    <h2>üèì Matches</h2>
    <div class="matches-actions">
      <div>
        <button id="addMatchBtn">‚ûï Ajouter un match</button>
        <button id="clearScoresBtn" class="secondary">üßπ Effacer les scores</button>
      </div>
      <div class="hint">
        Choisis les joueurs de chaque √©quipe, saisis les points A/B :<br>
        les classements se mettent √† jour automatiquement (donn√©es gard√©es dans le navigateur).
      </div>
    </div>

    <div style="max-height: 420px; overflow:auto; border:1px solid #e0e0e0; border-radius:8px;">
      <table id="matchesTable">
        <thead>
          <tr>
            <th>#</th><th>H A</th><th>F A</th><th>H B</th><th>F B</th><th>Pts A</th><th>Pts B</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <section class="card">
    <h2>üìä Classements</h2>
    <div class="standings-container">
      <div>
        <h3>üèÜ Global</h3>
        <table id="tableGlobal">
          <thead><tr><th>Rang</th><th>Joueur</th><th>Sexe</th><th>Points</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div>
        <h3>üë® Hommes</h3>
        <table id="tableMen">
          <thead><tr><th>Rang</th><th>Joueur</th><th>Points</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div>
        <h3>üë© Femmes</h3>
        <table id="tableWomen">
          <thead><tr><th>Rang</th><th>Joueur</th><th>Points</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>
</main>

<script>
const MEN = ["Quentin S","Jenda","Lo√Øc Suzini","Lo√Øc Kourou","Jules","Andreas","Romain","Quentin C","Patrice"];
const WOMEN = ["Karine","Manon","√âmilie","Marine","Camille","Tamily","Eliana","Erika","Myl√®ne","Guylmour","Emma","Melanie"];
const PLAYERS = [
  ...MEN.map(n => ({name:n, sex:"H"})),
  ...WOMEN.map(n => ({name:n, sex:"F"}))
];
const STORAGE_KEY = "americano_matches_v1";

let matches = [];

function renderPlayers() {
  const box = document.getElementById("playersList");
  box.innerHTML = PLAYERS.map(p => `
    <div class="badge">
      <span class="role ${p.sex}">${p.sex}</span>
      <span class="name">${p.name}</span>
    </div>`).join("");
}

function optionsFor(sex){
  return ['<option value=""></option>',
    ...PLAYERS.filter(p=>p.sex===sex).map(p=>`<option value="${p.name}">${p.name}</option>`)]
    .join("");
}
const OPT_M = optionsFor("H");
const OPT_F = optionsFor("F");

function addMatch() {
  matches.push({manA:"",womanA:"",manB:"",womanB:"",ptsA:"",ptsB:""});
  saveMatches();
  renderMatches();
  recompute();
}

function clearScores() {
  if(!confirm("Effacer tous les scores (les matchs restent) ?")) return;
  matches = matches.map(m => ({...m, ptsA:"", ptsB:""}));
  saveMatches();
  renderMatches();
  recompute();
}

function deleteMatch(i) {
  if(!confirm("Supprimer ce match ?")) return;
  matches.splice(i,1);
  saveMatches();
  renderMatches();
  recompute();
}

function renderMatches() {
  const tbody = document.querySelector("#matchesTable tbody");
  tbody.innerHTML = "";
  matches.forEach((m,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i+1}</td>
      <td><select data-i="${i}" data-f="manA">${OPT_M}</select></td>
      <td><select data-i="${i}" data-f="womanA">${OPT_F}</select></td>
      <td><select data-i="${i}" data-f="manB">${OPT_M}</select></td>
      <td><select data-i="${i}" data-f="womanB">${OPT_F}</select></td>
      <td><input type="number" min="0" data-i="${i}" data-f="ptsA"></td>
      <td><input type="number" min="0" data-i="${i}" data-f="ptsB"></td>
      <td><button class="danger" onclick="deleteMatch(${i})">‚úñ</button></td>
    `;
    tbody.appendChild(tr);
  });
  // Remplir les valeurs
  tbody.querySelectorAll("select").forEach(sel=>{
    const i = sel.dataset.i, f = sel.dataset.f;
    sel.value = matches[i][f] || "";
    sel.onchange = e => { matches[i][f]=e.target.value; saveMatches(); recompute(); };
  });
  tbody.querySelectorAll("input[type='number']").forEach(inp=>{
    const i = inp.dataset.i, f = inp.dataset.f;
    inp.value = matches[i][f] !== "" ? matches[i][f] : "";
    inp.oninput = e => { matches[i][f]=e.target.value===""?"":Number(e.target.value); saveMatches(); recompute(); };
  });
}

function saveMatches(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(matches)); }
function loadMatches(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    matches = raw ? JSON.parse(raw) : [];
  }catch(e){ matches = []; }
}

function recompute() {
  const pts = {};
  PLAYERS.forEach(p => pts[p.name]=0);
  matches.forEach(m=>{
    if(m.manA && m.womanA && m.manB && m.womanB && m.ptsA!=="" && m.ptsB!==""){
      const a = Number(m.ptsA), b = Number(m.ptsB);
      if(!isNaN(a)){ pts[m.manA]+=a; pts[m.womanA]+=a; }
      if(!isNaN(b)){ pts[m.manB]+=b; pts[m.womanB]+=b; }
    }
  });
  const all = PLAYERS.map(p => ({...p, pts: pts[p.name]||0}));
  const global = [...all].sort((x,y)=>y.pts-x.pts || x.name.localeCompare(y.name));
  const men   = global.filter(p=>p.sex==="H");
  const women = global.filter(p=>p.sex==="F");
  fillTable("#tableGlobal", global, true);
  fillTable("#tableMen", men, false);
  fillTable("#tableWomen", women, false);
}

function fillTable(selector, list, withSex){
  const tb = document.querySelector(selector+" tbody");
  tb.innerHTML = "";
  list.forEach((p,idx)=>{
    tb.innerHTML += `<tr>
      <td>${idx+1}</td>
      <td>${p.name}</td>
      ${withSex?`<td>${p.sex}</td>`:""}
      <td>${p.pts}</td>
    </tr>`;
  });
}

document.addEventListener("DOMContentLoaded", ()=>{
  renderPlayers();
  loadMatches();
  if(matches.length===0){
    for(let i=0;i<10;i++) matches.push({manA:"",womanA:"",manB:"",womanB:"",ptsA:"",ptsB:""});
    saveMatches();
  }
  renderMatches();
  recompute();
  document.getElementById("addMatchBtn").onclick = addMatch;
  document.getElementById("clearScoresBtn").onclick = clearScores;
});
</script>
</body>
</html>